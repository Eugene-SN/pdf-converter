[2025-10-15T17:16:51.196+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: quality_assurance.generate_comprehensive_qa_report manual__2025-10-15T17:15:24.321346+00:00 [queued]>
[2025-10-15T17:16:51.202+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: quality_assurance.generate_comprehensive_qa_report manual__2025-10-15T17:15:24.321346+00:00 [queued]>
[2025-10-15T17:16:51.202+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-15T17:16:51.210+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): generate_comprehensive_qa_report> on 2025-10-15 17:15:24.321346+00:00
[2025-10-15T17:16:51.216+0000] {standard_task_runner.py:60} INFO - Started process 264 to run task
[2025-10-15T17:16:51.218+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'quality_assurance', 'generate_comprehensive_qa_report', 'manual__2025-10-15T17:15:24.321346+00:00', '--job-id', '1577', '--raw', '--subdir', 'DAGS_FOLDER/quality_assurance.py', '--cfg-path', '/tmp/tmpwhvdofdn']
[2025-10-15T17:16:51.221+0000] {standard_task_runner.py:88} INFO - Job 1577: Subtask generate_comprehensive_qa_report
[2025-10-15T17:16:51.264+0000] {task_command.py:423} INFO - Running <TaskInstance: quality_assurance.generate_comprehensive_qa_report manual__2025-10-15T17:15:24.321346+00:00 [running]> on host ee1be49cded6
[2025-10-15T17:16:51.469+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='pdf-converter' AIRFLOW_CTX_DAG_ID='quality_assurance' AIRFLOW_CTX_TASK_ID='generate_comprehensive_qa_report' AIRFLOW_CTX_EXECUTION_DATE='2025-10-15T17:15:24.321346+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-15T17:15:24.321346+00:00'
[2025-10-15T17:16:51.527+0000] {quality_assurance.py:2016} INFO - Comprehensive QA report flagged manual follow-up: auto-correction status needs_review
[2025-10-15T17:16:51.527+0000] {shared_utils.py:213} INFO - 📊 Метрики: {'dag_id': 'quality_assurance', 'task_id': 'generate_comprehensive_qa_report', 'processing_time_seconds': 0.05758786201477051, 'pages_processed': 0, 'file_size_mb': 0.0, 'success': True, 'timestamp': '2025-10-15T17:16:51.527901'}
[2025-10-15T17:16:51.528+0000] {quality_assurance.py:2069} INFO - 📊 Полный QA отчет создан: 66.0% - ❌ NEEDS REVIEW
[2025-10-15T17:16:51.528+0000] {python.py:201} INFO - Done. Returned value was: {'session_id': 'qa_full_1760548526', 'document_file': '/app/output/zh/1760548393_test_short.md', 'qa_completion_time': '2025-10-15T17:16:51.527284', 'overall_score': 65.96085017500283, 'quality_passed': False, 'enterprise_validation': True, 'level_results': {'level1_ocr_validation': {'level': 1, 'name': 'ocr_cross_validation', 'consensus_confidence': 0.7, 'validation_score': 0.7, 'engines_used': [], 'issues_found': ['OCR results not found in Stage 1 artifacts'], 'processing_time': 0.019021272659301758, 'data_sources': {'bridge_file': '/opt/***/temp/stage1_bridge_1760548393.json', 'results_path': None, 'candidates_checked': ['/opt/***/temp/doc_1760548399/doc_1760548399_intermediate.json', '/opt/***/temp/doc_1760548399/doc_1760548399_result.json'], 'missing_files': ['/opt/***/temp/doc_1760548399/doc_1760548399_intermediate.json']}}, 'level2_visual_comparison': {'level': 2, 'name': 'visual_comparison', 'overall_similarity': 1.0, 'ssim_score': 1.0, 'differences_count': 0, 'issues_found': [], 'processing_time': 0.0782010555267334, 'pandoc_integration': True, 'validation_score': 1.0, 'pages_compared': 0, 'diff_summary': {'status': 'skipped', 'reason': 'visual_diff_unavailable'}, 'diff_image_paths': [], 'result_pdf_path': '/opt/***/temp/1760548393_test_short/1760548393_test_short_result.pdf'}, 'level3_ast_structure': {'level': 3, 'name': 'ast_structure_comparison', 'structural_similarity': 0.7999999999999999, 'semantic_similarity': 0.9, 'validation_score': 0.85, 'issues_found': ['Low structural similarity: 0.800'], 'processing_time': 0.01634669303894043}, 'level4_content_validation': {'level': 4, 'name': 'enhanced_content_validation', 'overall_score': 74.80425087501412, 'quality_passed': False, 'validation_score': 0.7480425087501412, 'detailed_scores': {'structure': 1.0, 'content': 0.5, 'terms': 1.0, 'markdown': 1.0, 'translation': 0.08434007000112914, 'formatting': 1.0, 'consistency': 1.0, 'completeness': 0.4}, 'issues_found': ['Пустые разделы: 3', 'Высокий уровень повторов: 38.5%', 'Осталось китайских символов: 18.3%', 'Недостаточно основных секций: 0/4'], 'processing_time': 0.01706409454345703, 'translation_quality_metrics': {'total_chars': 8857, 'chinese_chars': 1622, 'chinese_ratio': 0.18313198599977418, 'chinese_translation_coverage': 0.8168680140002258, 'technical_terms_total': 0, 'technical_terms_remaining': 0, 'technical_terms_translated': 0, 'technical_terms_coverage': 1.0, 'chunks_failed': None, 'threshold_passed': True}, 'chinese_ratio': 0.18313198599977418, 'chunks_failed': None}, 'level5_auto_correction': {'level': 5, 'name': 'auto_correction', 'corrections_applied': 0, 'correction_confidence': 0.0, 'corrected_content': '# 命令列表\n\n| 命令名称 | NetFn | CMD | 权限级别 | 备注 |\n|---------|------|-----|----------|------|\n| `chassis status` | - | - | User | 获取当前服务器 (Server) 状态 |\n| `chassis restart_cause` | - | - | User | 获取服务器 (Server) 系统上次重启原因 |\n| `chassis selftest` | - | - | User | 获取服务器 (Server) 系统自检结果 |\n| `chassis policy always-on/previous/always-off` | - | - | Operator | 设置服务器 (Server) 系统电源 (Power Supply) 恢复策略为：自动开机 / 恢复至断电前状态 / 保持关机状态 |\n| `chassis bootdev {device}` | - | - | Operator | 设置服务器 (Server) 的启动设备 |\n| `power status` | - | - | User | 获取服务器 (Server) 系统电源 (Power Supply) 当前状态 |\n| `power on/up` | - | - | Operator | 设置服务器 (Server) 开机 |\n| `power off/down` | - | - | Operator | 设置服务器 (Server) 关机 |\n| `power reset` | - | - | Operator | 设置服务器 (Server) 重启 |\n| `mc info` | - | - | User | 获取服务器 (Server) 管理系统各模块信息 |\n| `mc selftest` | - | - | User | 获取服务器 (Server) 管理系统自检结果 |\n| `mc reset cold` | - | - | Admin | 设置服务器 (Server) 管理系统冷重启 |\n| `sdr` | - | - | User | 获取服务器 (Server) 所有传感器的部分信息 |\n| `sensor list` | - | - | User | 获取服务器 (Server) 所有传感器的详细参数信息 |\n| `sensor get {sensor-name}` | - | - | User | 获取服务器 (Server) 指定传感器的详细信息 |\n| `sensor thresh {sensor-name}` | - | - | Admin | 设置服务器 (Server) 指定传感器的阈值 |\n| `sel` | - | - | User | 获取系统事件日志 (SEL) 信息 |\n| `sel elist` | - | - | User | 获取系统详细日志记录 |\n| `fru` | - | - | User | 获取现场可替换单元 (FRU) 信息 |\n| `session info active` | - | - | User | 获取服务器 (Server) 管理系统当前活跃用户的会话信息 |\n| `user list` | - | - | User | 获取所有用户信息 |\n| `user set name {User id} {Username}` | - | - | Admin | 设置服务器 (Server) 管理系统新增用户名 |\n| `user set password {User id} {password}` | - | - | Admin | 设置服务器 (Server) 管理系统指定用户的密码 |\n| `user test {User id} {16|20} {password}` | - | - | Admin | 验证用户名与密码的正确性 |\n| `user disable {User id}` | - | - | Admin | 禁用指定用户的服务器 (Server) 管理系统访问权限 |\n| `user enable {User id}` | - | - | Admin | 启用指定用户的服务器 (Server) 管理系统访问权限 |\n| `user priv {User id} {privilege level}` | - | - | Admin | 设置指定用户的服务器 (Server) 管理系统访问权限等级 |\n\n> **说明**：  \n> - 所有命令均适用于联想问天 (Lenovo WenTian) 系列服务器，兼容天擎 (ThinkSystem) 平台。  \n> - 支持英特尔 (Intel) 至强 (Xeon) 处理器平台，适用于企业级数据中心部署。  \n> - 权限级别说明：  \n>   - `User`：普通用户权限，仅可读取信息。  \n>   - `Operator`：操作员权限，可执行设备控制命令。  \n>   - `Admin`：管理员权限，可配置系统参数及用户管理。\n\n# 服务器 (Server) 管理系统用户与电源策略配置\n\n## 用户管理命令\n\n| 命令 | 参数说明 | 权限级别 | 用途 |\n|------|----------|----------|------|\n| `User set name {User id} {Username}` | 设置服务器 (Server)管理系统新增用户名 | Admin |  |\n| `User set password {User id} {password}` | 设置服务器 (Server)管理系统指定用户的密码 | Admin |  |\n| `User test {User id} {16 | 20} {password}` | 验证用户名与密码的正确性 | Admin |  |\n| `User disable {User id}` | 关闭指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n| `User enable {User id}` | 开启指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n| `User priv {User id} {privilege level}` | 设置指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n\n## chassis selftest（获取服务器 (Server)系统自检结果）\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis selftest` 命令用于获取服务器 (Server)系统自检结果 |\n| **权限级别** | user |\n| **命令示例** | `lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis selftest`<br>**输出结果**：`Self Test Results : passed` |\n\n## chassis policy always-on/previous/always-off（设置服务器 (Server)系统电源 (Power Supply)恢复策略）\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis policy` 命令用于设置服务器 (Server)系统电源 (Power Supply)恢复策略。支持以下三种策略：<br>1. `always-on`：当服务器 (Server)电源 (Power Supply)接通后，系统自动启动<br>2. `previous`：当服务器 (Server)电源 (Power Supply)接通后，系统恢复断电前的电源状态<br>3. `always-off`：当服务器 (Server)电源 (Power Supply)接通后，系统保持关机状态 |\n| **权限级别** | operator |\n| **命令示例** | `lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis policy state <state>`<br>**支持操作**：<br>- `list`：返回支持的策略列表 |\n\nstate <state>\n```\n| **查询支持策略** | `lenovo:~# ipmitool lanplus chassis policy state list`（返回支持的策略列表） |\n\n---\n\n### 设置启动设备（chassis bootdev）\n\n`chassis bootdev` 命令用于设置服务器（Server）系统的**一次性启动项**（One-time Boot Device），适用于临时更改启动顺序，例如从光盘或网络启动。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis bootdev` 命令用于设置服务器（Server）系统的一次性启动设备 |\n| **权限级别** | operator |\n| **命令格式** | `ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis bootdev <device> [options]` |\n| **常用启动设备** | `pxe`（PXE网络启动）、`cdrom`（光盘）、`disk`（硬盘）、`bios`（BIOS设置界面）等 |\n\n> **注意**：该命令为一次性生效，重启后恢复默认启动顺序。\n\n---\n\n### 激活 SOL 功能（sol activate）\n\nSOL（Serial Over LAN）功能允许通过网络远程访问服务器（Server）的串行控制台，实现远程调试与系统维护。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `sol activate` 命令用于激活 SOL 会话，建立远程串行控制台连接 |\n| **权限级别** | administrator |\n| **命令示例** |  \n```bash\nlenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol activate \\\n  usesolkeepalive\n```\n> **输出提示**：`[SOL Session operational. Use ~? for help]`  \n> **操作说明**：激活后可通过 `~?` 查看 SOL 会话帮助命令，如 `~.` 断开连接。\n\n---\n\n### 关闭 SOL 功能（sol deactivate）\n\n`sol deactivate` 命令用于终止当前激活的 SOL 会话，释放远程串行控制台资源。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `sol deactivate` 命令用于关闭当前激活的 SOL 会话 |\n| **权限级别** | administrator |\n| **命令示例** |  \n```bash\nlenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol deactivate\n```\n\n---\n\n### Lenovo BMC 支持的 OEM RAW 命令\n\n以下为 Lenovo BMC（如 联想问天 WenTian、天擎 ThinkSystem 系列服务器）支持的 OEM RAW 命令列表（部分示例）：\n\n| 命令 | 功能说明 |\n|------|----------|\n| `raw 0x30 0x01` | 查询系统状态（如电源、温度、风扇等） |\n| `raw 0x30 0x02` | 设置系统启动设备（一次性） |\n| `raw 0x30 0x03` | 获取系统启动历史记录 |\n| `raw 0x30 0x04` | 重启服务器（强制） |\n| `raw 0x30 0x05` | 获取 BIOS 版本信息 |\n| `raw 0x30 0x06` | 设置 BMC 网络参数（IP、子网掩码、网关） |\n| `raw 0x30 0x07` | 重置 BMC 配置至出厂默认值 |\n\n> **说明**：  \n> - 所有 OEM RAW 命令均需通过 `ipmitool` 的 `raw` 子命令调用。  \n> - 命令格式：`ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus raw 0x30 <sub-function>`  \n> - 适用于 联想问天 (Lenovo WenTian)、天擎 (ThinkSystem) 系列服务器，支持 英特尔 (Intel) 至强 (Xeon) 处理器平台。\n\n# SOL（Serial Over LAN）功能操作\n\n## sol activate（激活 SOL 功能）\n\n| 项目 | 说明 |\n|------|------|\n| 命令描述 | `sol activate` 命令用于激活 SOL（Serial Over LAN）功能 |\n| 权限要求 | administrator |\n| 命令示例 | ```bash<br>lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol activate usesolkeepalive<br>[SOL Session operational. Use ~? for help]<br>``` |\n\n## sol deactivate（关闭 SOL 功能）\n\n| 项目 | 说明 |\n|------|------|\n| 命令描述 | `sol deactivate` 命令用于关闭 SOL（Serial Over LAN）功能 |\n| 权限要求 | administrator |\n| 命令示例 | ```bash<br>lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol deactivate<br>``` |\n\n---\n\n## Lenovo BMC 支持的 OEM RAW 命令\n\n### Get SNMP Trap Info（获取 SNMP Trap 信息）\n\n| 命令 | `netfn=0x30`, `cmd=0x02` |\n|------|--------------------------|\n\n#### 请求数据（Request Data）\n\n| 字节 | 数据字段 |\n|------|----------|\n| 1    | 用户 ID，取值范围：01h 至 05h |\n| 2    | 参数类型：<br>01h - enable<br>02h - severity<br>03h - version<br>04h - mode<br>05h - community<br>06h - user<br>07h - user encrypt<br>08h - password<br>09h - pass encrypt<br>0Ah - destination IP<br>0Bh - port<br>0Ch - LAN 通道<br>0Dh - enter ID |\n\n#### 响应数据（Response Data）\n\n| 参数 | 字节 | 数据字段 |\n|------|------|----------|\n| 01h (enable) | 1 | 完成码<br>2 | 00h - disable<br>01h - enable |\n| 02h (severity) | 1 | 完成码<br>2 | 01h - critical<br>02h - critical and warning<br>03h - all |\n| 03h (version) | 1 | 完成码<br>2 | 01h - v1<br>02h - v2c<br>03h - v3 |\n| 04h (mode) | 1 | 完成码<br>2 | 模式值 |\n| 05h (community) | 1 | 完成码<br>2:17 | community 字符串 |\n| 06h (user) | 1 | 完成码<br>2:17 | 用户名字符串 |\n| 07h (user encrypt) | 1 | 完成码<br>2 | 00h - 用户加密<br>01h - 用户非加密 |\n| 08h (password) | 1 | 完成码<br>2:17 | 密码字符串 |\n| 09h (pass encrypt) | 1 | 完成码<br>2 | 00h - 密码加密<br>01h - 密码非加密 |\n| 0Ah (destination IP) | 1 | 完成码<br>2:33 | 目标 IP 地址 |\n| 0Bh (port) | 1 | 完成码<br>2:3 | 端口号 |\n| 0Ch (LAN channel) | 1 | 完成码<br>2 | LAN 通道编号 |\n| 0Dh (enter ID) | 1 | 完成码<br>2:33 | Enter ID 值 |\n\n#### 命令示例\n\n```bash\n# ipmitool -H 10.109.107.160 -U USERID -P PASSW0RD raw 0x30 0x02 01 01\n```\n\n```markdown\n### 设置 SNMP Trap 信息（Set SNMP Trap Info）\n\n| 命令 | `netfn=0x30`, `cmd=0x03` |\n|------|--------------------------|\n\n#### 请求数据（Request Data）\n\n| 字节 (Byte) | 数据字段 (Data Field) |\n|-------------|------------------------|\n| 1           | 用户 ID（取值范围：01h–05h） |\n| 2           | 参数标识（Parameter ID）：<br>• 01h：启用/禁用<br>• 02h：严重级别<br>• 03h：版本<br>• 04h：模式<br>• 05h：团体名（Community）<br>• 06h：用户名（User）<br>• 07h：用户加密标志<br>• 08h：密码（Password）<br>• 09h：密码加密标志<br>• 0Ah：目标 IP 地址（Destination IP）<br>• 0Bh：端口（Port）<br>• 0Ch：LAN 通道（LAN Channel）<br>• 0Dh：进入 ID（Enter ID） |\n| 3           | 参数值说明：<br>• **01h**：启用/禁用<br>\u3000\u3000- 00h：禁用<br>\u3000\u3000- 01h：启用<br>• **02h**：严重级别<br>\u3000\u3000- 01h：严重（Critical）<br>\u3000\u3000- 02h：严重和警告（Critical & Warning）<br>\u3000\u3000- 03h：全部（All）<br>• **03h**：版本<br>\u3000\u3000- 01h：SNMPv1<br>\u3000\u3000- 02h：SNMPv2c<br>\u3000\u3000- 03h：SNMPv3 |\n\n#### 响应数据（Response Data）\n\n| 字节 (Byte) | 数据字段 (Data Field) |\n|-------------|------------------------|\n| 1           | 完成码（Completion Code） |\n\n#### 命令示例（Command Example）\n\n```bash\n# ipmitool -H 10.109.107.160 -U USERID -P PASSW0RD raw 0x30 0x03 0x01 0x01 0x02 0x03 0x01 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D\n```\n\n> **说明**：  \n> - 本命令用于配置 SNMP Trap 通知参数，适用于联想问天（Lenovo WenTian）系列服务器及天擎（ThinkSystem）平台。  \n> - 所有参数需按顺序填写，确保与目标设备的 SNMP 配置一致。  \n> - 支持的处理器平台包括至强（Xeon）系列，兼容英特尔（Intel）架构。  \n> - 请确保网络通道（LAN Channel）和目标 IP 地址配置正确，以保障 Trap 消息可达。\n```\n```\n', 'validation_score': 0.0, 'issues_found': ['vLLM correction confidence too low: 0.000'], 'processing_time': 79.67773604393005, 'timed_out': False, 'warmup_requested': False, 'retry_scheduled': False, 'status': 'needs_review', 'partial_success': False, 'requires_manual_followup': True}}, 'level_scores': {'level_1': 0.7, 'level_2': 1.0, 'level_3': 0.85, 'level_4': 0.7480425087501412, 'level_5': 0.0}, 'all_issues': ['OCR results not found in Stage 1 artifacts', 'Low structural similarity: 0.800', 'Пустые разделы: 3', 'Высокий уровень повторов: 38.5%', 'Осталось китайских символов: 18.3%', 'Недостаточно основных секций: 0/4', 'vLLM correction confidence too low: 0.000'], 'corrections_applied': 0, 'corrected_content': '# 命令列表\n\n| 命令名称 | NetFn | CMD | 权限级别 | 备注 |\n|---------|------|-----|----------|------|\n| `chassis status` | - | - | User | 获取当前服务器 (Server) 状态 |\n| `chassis restart_cause` | - | - | User | 获取服务器 (Server) 系统上次重启原因 |\n| `chassis selftest` | - | - | User | 获取服务器 (Server) 系统自检结果 |\n| `chassis policy always-on/previous/always-off` | - | - | Operator | 设置服务器 (Server) 系统电源 (Power Supply) 恢复策略为：自动开机 / 恢复至断电前状态 / 保持关机状态 |\n| `chassis bootdev {device}` | - | - | Operator | 设置服务器 (Server) 的启动设备 |\n| `power status` | - | - | User | 获取服务器 (Server) 系统电源 (Power Supply) 当前状态 |\n| `power on/up` | - | - | Operator | 设置服务器 (Server) 开机 |\n| `power off/down` | - | - | Operator | 设置服务器 (Server) 关机 |\n| `power reset` | - | - | Operator | 设置服务器 (Server) 重启 |\n| `mc info` | - | - | User | 获取服务器 (Server) 管理系统各模块信息 |\n| `mc selftest` | - | - | User | 获取服务器 (Server) 管理系统自检结果 |\n| `mc reset cold` | - | - | Admin | 设置服务器 (Server) 管理系统冷重启 |\n| `sdr` | - | - | User | 获取服务器 (Server) 所有传感器的部分信息 |\n| `sensor list` | - | - | User | 获取服务器 (Server) 所有传感器的详细参数信息 |\n| `sensor get {sensor-name}` | - | - | User | 获取服务器 (Server) 指定传感器的详细信息 |\n| `sensor thresh {sensor-name}` | - | - | Admin | 设置服务器 (Server) 指定传感器的阈值 |\n| `sel` | - | - | User | 获取系统事件日志 (SEL) 信息 |\n| `sel elist` | - | - | User | 获取系统详细日志记录 |\n| `fru` | - | - | User | 获取现场可替换单元 (FRU) 信息 |\n| `session info active` | - | - | User | 获取服务器 (Server) 管理系统当前活跃用户的会话信息 |\n| `user list` | - | - | User | 获取所有用户信息 |\n| `user set name {User id} {Username}` | - | - | Admin | 设置服务器 (Server) 管理系统新增用户名 |\n| `user set password {User id} {password}` | - | - | Admin | 设置服务器 (Server) 管理系统指定用户的密码 |\n| `user test {User id} {16|20} {password}` | - | - | Admin | 验证用户名与密码的正确性 |\n| `user disable {User id}` | - | - | Admin | 禁用指定用户的服务器 (Server) 管理系统访问权限 |\n| `user enable {User id}` | - | - | Admin | 启用指定用户的服务器 (Server) 管理系统访问权限 |\n| `user priv {User id} {privilege level}` | - | - | Admin | 设置指定用户的服务器 (Server) 管理系统访问权限等级 |\n\n> **说明**：  \n> - 所有命令均适用于联想问天 (Lenovo WenTian) 系列服务器，兼容天擎 (ThinkSystem) 平台。  \n> - 支持英特尔 (Intel) 至强 (Xeon) 处理器平台，适用于企业级数据中心部署。  \n> - 权限级别说明：  \n>   - `User`：普通用户权限，仅可读取信息。  \n>   - `Operator`：操作员权限，可执行设备控制命令。  \n>   - `Admin`：管理员权限，可配置系统参数及用户管理。\n\n# 服务器 (Server) 管理系统用户与电源策略配置\n\n## 用户管理命令\n\n| 命令 | 参数说明 | 权限级别 | 用途 |\n|------|----------|----------|------|\n| `User set name {User id} {Username}` | 设置服务器 (Server)管理系统新增用户名 | Admin |  |\n| `User set password {User id} {password}` | 设置服务器 (Server)管理系统指定用户的密码 | Admin |  |\n| `User test {User id} {16 | 20} {password}` | 验证用户名与密码的正确性 | Admin |  |\n| `User disable {User id}` | 关闭指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n| `User enable {User id}` | 开启指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n| `User priv {User id} {privilege level}` | 设置指定用户的服务器 (Server)管理系统访问权限 | Admin |  |\n\n## chassis selftest（获取服务器 (Server)系统自检结果）\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis selftest` 命令用于获取服务器 (Server)系统自检结果 |\n| **权限级别** | user |\n| **命令示例** | `lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis selftest`<br>**输出结果**：`Self Test Results : passed` |\n\n## chassis policy always-on/previous/always-off（设置服务器 (Server)系统电源 (Power Supply)恢复策略）\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis policy` 命令用于设置服务器 (Server)系统电源 (Power Supply)恢复策略。支持以下三种策略：<br>1. `always-on`：当服务器 (Server)电源 (Power Supply)接通后，系统自动启动<br>2. `previous`：当服务器 (Server)电源 (Power Supply)接通后，系统恢复断电前的电源状态<br>3. `always-off`：当服务器 (Server)电源 (Power Supply)接通后，系统保持关机状态 |\n| **权限级别** | operator |\n| **命令示例** | `lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis policy state <state>`<br>**支持操作**：<br>- `list`：返回支持的策略列表 |\n\nstate <state>\n```\n| **查询支持策略** | `lenovo:~# ipmitool lanplus chassis policy state list`（返回支持的策略列表） |\n\n---\n\n### 设置启动设备（chassis bootdev）\n\n`chassis bootdev` 命令用于设置服务器（Server）系统的**一次性启动项**（One-time Boot Device），适用于临时更改启动顺序，例如从光盘或网络启动。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `chassis bootdev` 命令用于设置服务器（Server）系统的一次性启动设备 |\n| **权限级别** | operator |\n| **命令格式** | `ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis bootdev <device> [options]` |\n| **常用启动设备** | `pxe`（PXE网络启动）、`cdrom`（光盘）、`disk`（硬盘）、`bios`（BIOS设置界面）等 |\n\n> **注意**：该命令为一次性生效，重启后恢复默认启动顺序。\n\n---\n\n### 激活 SOL 功能（sol activate）\n\nSOL（Serial Over LAN）功能允许通过网络远程访问服务器（Server）的串行控制台，实现远程调试与系统维护。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `sol activate` 命令用于激活 SOL 会话，建立远程串行控制台连接 |\n| **权限级别** | administrator |\n| **命令示例** |  \n```bash\nlenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol activate \\\n  usesolkeepalive\n```\n> **输出提示**：`[SOL Session operational. Use ~? for help]`  \n> **操作说明**：激活后可通过 `~?` 查看 SOL 会话帮助命令，如 `~.` 断开连接。\n\n---\n\n### 关闭 SOL 功能（sol deactivate）\n\n`sol deactivate` 命令用于终止当前激活的 SOL 会话，释放远程串行控制台资源。\n\n| 项目 | 说明 |\n|------|------|\n| **命令描述** | `sol deactivate` 命令用于关闭当前激活的 SOL 会话 |\n| **权限级别** | administrator |\n| **命令示例** |  \n```bash\nlenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol deactivate\n```\n\n---\n\n### Lenovo BMC 支持的 OEM RAW 命令\n\n以下为 Lenovo BMC（如 联想问天 WenTian、天擎 ThinkSystem 系列服务器）支持的 OEM RAW 命令列表（部分示例）：\n\n| 命令 | 功能说明 |\n|------|----------|\n| `raw 0x30 0x01` | 查询系统状态（如电源、温度、风扇等） |\n| `raw 0x30 0x02` | 设置系统启动设备（一次性） |\n| `raw 0x30 0x03` | 获取系统启动历史记录 |\n| `raw 0x30 0x04` | 重启服务器（强制） |\n| `raw 0x30 0x05` | 获取 BIOS 版本信息 |\n| `raw 0x30 0x06` | 设置 BMC 网络参数（IP、子网掩码、网关） |\n| `raw 0x30 0x07` | 重置 BMC 配置至出厂默认值 |\n\n> **说明**：  \n> - 所有 OEM RAW 命令均需通过 `ipmitool` 的 `raw` 子命令调用。  \n> - 命令格式：`ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus raw 0x30 <sub-function>`  \n> - 适用于 联想问天 (Lenovo WenTian)、天擎 (ThinkSystem) 系列服务器，支持 英特尔 (Intel) 至强 (Xeon) 处理器平台。\n\n# SOL（Serial Over LAN）功能操作\n\n## sol activate（激活 SOL 功能）\n\n| 项目 | 说明 |\n|------|------|\n| 命令描述 | `sol activate` 命令用于激活 SOL（Serial Over LAN）功能 |\n| 权限要求 | administrator |\n| 命令示例 | ```bash<br>lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol activate usesolkeepalive<br>[SOL Session operational. Use ~? for help]<br>``` |\n\n## sol deactivate（关闭 SOL 功能）\n\n| 项目 | 说明 |\n|------|------|\n| 命令描述 | `sol deactivate` 命令用于关闭 SOL（Serial Over LAN）功能 |\n| 权限要求 | administrator |\n| 命令示例 | ```bash<br>lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol deactivate<br>``` |\n\n---\n\n## Lenovo BMC 支持的 OEM RAW 命令\n\n### Get SNMP Trap Info（获取 SNMP Trap 信息）\n\n| 命令 | `netfn=0x30`, `cmd=0x02` |\n|------|--------------------------|\n\n#### 请求数据（Request Data）\n\n| 字节 | 数据字段 |\n|------|----------|\n| 1    | 用户 ID，取值范围：01h 至 05h |\n| 2    | 参数类型：<br>01h - enable<br>02h - severity<br>03h - version<br>04h - mode<br>05h - community<br>06h - user<br>07h - user encrypt<br>08h - password<br>09h - pass encrypt<br>0Ah - destination IP<br>0Bh - port<br>0Ch - LAN 通道<br>0Dh - enter ID |\n\n#### 响应数据（Response Data）\n\n| 参数 | 字节 | 数据字段 |\n|------|------|----------|\n| 01h (enable) | 1 | 完成码<br>2 | 00h - disable<br>01h - enable |\n| 02h (severity) | 1 | 完成码<br>2 | 01h - critical<br>02h - critical and warning<br>03h - all |\n| 03h (version) | 1 | 完成码<br>2 | 01h - v1<br>02h - v2c<br>03h - v3 |\n| 04h (mode) | 1 | 完成码<br>2 | 模式值 |\n| 05h (community) | 1 | 完成码<br>2:17 | community 字符串 |\n| 06h (user) | 1 | 完成码<br>2:17 | 用户名字符串 |\n| 07h (user encrypt) | 1 | 完成码<br>2 | 00h - 用户加密<br>01h - 用户非加密 |\n| 08h (password) | 1 | 完成码<br>2:17 | 密码字符串 |\n| 09h (pass encrypt) | 1 | 完成码<br>2 | 00h - 密码加密<br>01h - 密码非加密 |\n| 0Ah (destination IP) | 1 | 完成码<br>2:33 | 目标 IP 地址 |\n| 0Bh (port) | 1 | 完成码<br>2:3 | 端口号 |\n| 0Ch (LAN channel) | 1 | 完成码<br>2 | LAN 通道编号 |\n| 0Dh (enter ID) | 1 | 完成码<br>2:33 | Enter ID 值 |\n\n#### 命令示例\n\n```bash\n# ipmitool -H 10.109.107.160 -U USERID -P PASSW0RD raw 0x30 0x02 01 01\n```\n\n```markdown\n### 设置 SNMP Trap 信息（Set SNMP Trap Info）\n\n| 命令 | `netfn=0x30`, `cmd=0x03` |\n|------|--------------------------|\n\n#### 请求数据（Request Data）\n\n| 字节 (Byte) | 数据字段 (Data Field) |\n|-------------|------------------------|\n| 1           | 用户 ID（取值范围：01h–05h） |\n| 2           | 参数标识（Parameter ID）：<br>• 01h：启用/禁用<br>• 02h：严重级别<br>• 03h：版本<br>• 04h：模式<br>• 05h：团体名（Community）<br>• 06h：用户名（User）<br>• 07h：用户加密标志<br>• 08h：密码（Password）<br>• 09h：密码加密标志<br>• 0Ah：目标 IP 地址（Destination IP）<br>• 0Bh：端口（Port）<br>• 0Ch：LAN 通道（LAN Channel）<br>• 0Dh：进入 ID（Enter ID） |\n| 3           | 参数值说明：<br>• **01h**：启用/禁用<br>\u3000\u3000- 00h：禁用<br>\u3000\u3000- 01h：启用<br>• **02h**：严重级别<br>\u3000\u3000- 01h：严重（Critical）<br>\u3000\u3000- 02h：严重和警告（Critical & Warning）<br>\u3000\u3000- 03h：全部（All）<br>• **03h**：版本<br>\u3000\u3000- 01h：SNMPv1<br>\u3000\u3000- 02h：SNMPv2c<br>\u3000\u3000- 03h：SNMPv3 |\n\n#### 响应数据（Response Data）\n\n| 字节 (Byte) | 数据字段 (Data Field) |\n|-------------|------------------------|\n| 1           | 完成码（Completion Code） |\n\n#### 命令示例（Command Example）\n\n```bash\n# ipmitool -H 10.109.107.160 -U USERID -P PASSW0RD raw 0x30 0x03 0x01 0x01 0x02 0x03 0x01 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D\n```\n\n> **说明**：  \n> - 本命令用于配置 SNMP Trap 通知参数，适用于联想问天（Lenovo WenTian）系列服务器及天擎（ThinkSystem）平台。  \n> - 所有参数需按顺序填写，确保与目标设备的 SNMP 配置一致。  \n> - 支持的处理器平台包括至强（Xeon）系列，兼容英特尔（Intel）架构。  \n> - 请确保网络通道（LAN Channel）和目标 IP 地址配置正确，以保障 Trap 消息可达。\n```\n```\n', 'qa_rules_used': {'min_content_length': 100, 'min_headings': 1, 'max_chinese_chars_ratio': 0.2, 'require_title': True, 'check_table_structure': True, 'validate_markdown_syntax': True, 'technical_terms_check': True, 'preserve_brand_names': True, 'min_quality_score': 80.0, 'excellent_quality_score': 95.0, 'OCR_CONFIDENCE_THRESHOLD': 0.8, 'VISUAL_SIMILARITY_THRESHOLD': 0.95, 'AST_SIMILARITY_THRESHOLD': 0.9, 'SEMANTIC_SIMILARITY_THRESHOLD': 0.85, 'OVERALL_QA_THRESHOLD': 0.85, 'MAX_CORRECTIONS_PER_DOCUMENT': 10, 'AUTO_CORRECTION_CONFIDENCE': 0.7}, 'level_configs_used': {'level1_ocr': {'consensus_threshold': 0.85, 'similarity_threshold': 0.8, 'engines': ['paddleocr', 'tesseract']}, 'level2_visual': {'ssim_threshold': 0.95, 'difference_tolerance': 0.1, 'page_comparison_mode': 'structural', 'pandoc_integration': True}, 'level3_ast': {'structural_similarity_threshold': 0.9, 'semantic_similarity_threshold': 0.85, 'model_name': 'sentence-transformers/all-MiniLM-L6-v2'}, 'level4_content': {'min_technical_terms': 5, 'min_code_blocks': 1, 'formatting_score_threshold': 0.8}, 'level5_correction': {'vllm_endpoint': 'http://vllm-server:8000/v1/chat/completions', 'correction_model': 'Qwen/Qwen3-30B-A3B-Instruct-2507', 'max_retries': 5, 'enable_auto_correction': True}}, 'auto_correction_status': 'needs_review', 'auto_correction_partial_success': False, 'auto_correction_requires_manual_followup': True, 'report_file': '/opt/***/temp/qa_comprehensive_report_qa_full_1760548526.json'}
[2025-10-15T17:16:51.551+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=quality_assurance, task_id=generate_comprehensive_qa_report, execution_date=20251015T171524, start_date=20251015T171651, end_date=20251015T171651
[2025-10-15T17:16:51.590+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-10-15T17:16:51.613+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
